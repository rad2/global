<app-nav></app-nav>
<main>
    <div class="row">   
        <div class="col-xs-2">
            
            <div *ngIf="people">
                <ul class="list-group">
                    <li class="list-group-item" *ngFor="let p of people" (click)="selectPerson(p)" [class.active]="p===activeperson">
                        <h5>{{p.fname}} {{p.lname}}</h5>

                    </li>
                </ul>
            </div>

        </div>
        <div class="col-md-8">
            <div class="jumbotron" *ngIf="activeperson">
                 <form class="form-horizontal" >
                        <div class="row">
                                <div class="col-md-4">
                                    <div class="input-group">
                                        <span>First Name:</span>
                                        <input type="text" class="form-control input-md" name="fname" [value]="activeperson.fname" [(ngModel)]="activeperson.fname">{{activeperson.fname}}
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="input-group">
                                        <span >MI:</span>
                                        <input type="text" class="form-control input-md" name="mi" maxlength=2 [value]="activeperson.mi" [(ngModel)]="activeperson.mi">{{activeperson.mi}}   
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="input-group">
                                        <span >Last Name:</span>
                                        <input type="text" class="form-control input-md" name="lname" [value]= "activeperson.lname" [(ngModel)]="activeperson.lname">{{activeperson.lname}}   
                                    </div>
                                </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                    <div class="input-group">
                                        <span>Activation Date:</span>
                                        <input type="datetime" class="form-control input-md" name="p_activationdate" [value]="activeperson.p_activationdate" [(ngModel)]="activeperson.p_activationdate">{{activeperson.p_activationdate}}
                                    </div>
                            </div>
                             <div class="col-md-4">
                                    <div class="input-group">
                                        <span>Expiration Date:</span>
                                        <input type="datetime" class="form-control input-md" name="p_expirationdate" [value]="activeperson.p_expirationdate" [(ngModel)]="activeperson.p_expirationdate">{{activeperson.p_expirationdate}}
                                    </div>
                                </div>
                              
                        </div>
                       <div class="row">
                            <div class="col-lg-8">
                                    <div class="input-group">
                                        <span>Notes:</span>
                                        <input type="text" class="form-control input-lg" name="notes" [value]="activeperson.notes" [(ngModel)]="activeperson.notes">{{activeperson.notes}}
                                    </div>
                            </div>
                                                          
                       </div><br>
                       <div class="row">
                         <div class="col-lg-2">  
                             <span>Access Levels</span>
                             <div class="panel panel-default">
                              <div class="panel-body">
                               <select multiple name="alvl" #alvl_list size=15 (click)="add_als(alvl_list.value)">
                                    <option  *ngFor="let al of access_levels" [value]="" >
                                    {{al.partition}}-{{al.name}}
                                    </option>
                               </select>
                              </div>
                              </div>
                         </div> 
                         <div class="col-xs-2">
                             <span>&nbsp;</span>
                             <span>&nbsp;</span>
                             <span>&nbsp;</span>
                             <span>&nbsp;</span>
                             <span>&nbsp;</span>
                               <table>
                                   <tr>
                                       <td><button class="glyphicon glyphicon-chevron-left" (click)="remove_al()"></button></td>
                                    </tr>
                                    <tr>   
                                       <td><button class="glyphicon glyphicon-chevron-right" (click)="assign_als()"></button></td>
                                   </tr>
                               </table>
                           </div>
                        <div class="col-lg-8">
                            <span></span>
                                <table class="table table-bordered table-hover">
                                            <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Activation Date</th>
                                                <th>Expiration Date</th>
                                                <th>Auto Remove</th>
                                                <th>Expired</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                             <tr *ngFor="let al of activeperson.accesslevel">
                                                 <td>{{al.al_name}}</td>
                                                 <td><input type="datetime-local"  name="al_activationdate" [ngModel]="alvl.al_activationdate" [value]="al.al_activationdate">{{al.al_activationdate}}</td>
                                                 <td><input type="datetime-local"  name="al_expirationdate" [ngModel]="alvl.al_expirationdate" [value]="al.al_experitiondate">{{al.al_experitiondate}}</td>
                                                 <td><select  name="autoremove" [ngModel]="alvl.autoremove" >
                                                     <option [value]="" selected>Yes</option>
                                                     <option>No</option>
                                                     </select>
                                                 </td>
                                                 <td><select  name="expired" [ngModel]="alvl.expired" >
                                                     <option [value]="" selected>Yes</option>
                                                     <option>No</option>
                                                     </select>
                                                     </td>
                                             </tr>
                                             </tbody>
                                </table> 
                        </div>    
                         
                       </div>
                       <div class="row">
                         <div class="col-lg-8">
                             <span>Credentials</span>
                             <div class="panel panel-default">
                              <div class="panel-body">
                                        <table class="table table-bordered table-hover">
                                            <thead>
                                            <tr>
                                                <th></th>
                                                <th>Hot Stamp#</th>
                                                <th>Encoded#</th>
                                                <th>Card Format</th>
                                                <th>Status</th>
                                                <th>Expiration</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr *ngFor="let ac of activeperson.card" (click)="selectCard(ac)" [class.active]="ac===activecard">
                                                <td><button type="button" class="btn btn-default btn-xs" (click)="revokeCard(ac.cardid)">
                                                    <span class="glyphicon glyphicon-minus"></span>
                                                </button></td>
                                                <td>{{ac.hotstamp}}</td>
                                                <td>{{ac.encoded}}</td>
                                                <td>{{ac.cardformat}}</td>
                                                <td><select name="status" [ngModel] = "credentials.status">
                                                        <option value="Active">Active</option>
                                                        <option value="Lost">Lost</option>
                                                        <option value="Damaged">Damaged</option>
                                                        <option value="Expired">Expired</option>
                                                    </select>
                                                </td>
                                                <td>{{ac.expirationdate}}</td>
                                            </tr>
                                            <tr name="newrow" *ngIf="show">
                                                <td><button type="button" class="btn btn-default btn-xs" (click)="show=false" >
                                                    <span class="glyphicon glyphicon-minus"></span>
                                                </button></td>
                                                <td><input type="text" name="hotstamp" [ngModel] = "credentials.hotstamp"></td>
                                                <td><input type="text" name="encoded" [ngModel] = "credentials.encoded" ></td>
                                                <td>
                                                    <select name="cf" [ngModel] = "credentials.cardformat">
                                                    <option *ngFor ="let cf of card_format" [value]="cf.name"  selected >{{cf.name}}</option>
                                                    </select>
                                                </td>
                                                <td>
                                                    <select name="status" [ngModel] = "credentials.status">
                                                        <option value="Active">Active</option>
                                                        <option value="Lost">Lost</option>
                                                        <option value="Damaged">Damaged</option>
                                                        <option value="Expired">Expired</option>
                                                    </select>
                                                   
                                                </td>
                                                <td><input type="date" name="c_expirationdate" [ngModel] = "credentials.c_expirationdate" ></td>
                                             </tr>   
                                            </tbody>
                                        </table>  
                                 </div>
                                 <div class="panel-footer">
                                     <button type="button" class="btn btn-default btn-md" (click)="show=true">Add New Credential</button>
                                 </div>       
                           </div>  
                      </div>
                     </div>
                      <div class="panel-footer">
                            <button type="button" class="btn btn-default btn-md" (click)="savePerson(activeperson,credentials)">Save</button>
                    </div>
                </form>
               
            </div>
        </div>
    </div>
</main>